"use strict";var Type;!function(t){t[t.ELEMENT=0]="ELEMENT",t[t.CLOSE_ELEMENT=1]="CLOSE_ELEMENT",t[t.COMMENT=2]="COMMENT",t[t.CDATA=3]="CDATA"}(Type||(Type={}));var noOp=function(){},FastSax=function(){function u(){this.onText=noOp,this.onElementStart=noOp,this.onElementEnd=noOp,this.onCData=noOp,this.onComment=noOp}return u.prototype.parse=function(t){for(var n=null,E="\ufeff"===t.charAt(0)?1:0,e=E,r=E;r<t.length;r++)if(null!==n){if(n===Type.ELEMENT){if(-1===(o=t.indexOf(u.ELEMENT_SUFFIX,r)))break;for(var i=null,T=r;T<o;T++){var A=t.charCodeAt(T);if(A===u.FORWARD_SLASH||A===u.SPACE){i=t.substring(r,T),r=T;break}}null===i&&(i=t.substring(r,o)),i&&(this.onElementStart(i,function(){return u.extractAttributes(t,r,o)}),t.charCodeAt(o-1)===u.FORWARD_SLASH&&this.onElementEnd(i)),r=o}else if(n===Type.CLOSE_ELEMENT){if(-1===(o=t.indexOf(u.ELEMENT_SUFFIX,r)))break;this.onElementEnd(t.substring(r,o)),r=o}else if(n===Type.CDATA){if(-1===(o=t.indexOf(u.CDATA_SUFFIX,r)))break;this.onCData(function(){return t.substring(r,o)}),r=o+2}else if(n===Type.COMMENT){var o;if(-1===(o=t.indexOf(u.COMMENT_SUFFIX,r)))break;this.onComment(function(){return t.substring(r,o)}),r=o+2}e=r+1,n=null}else if(t.charCodeAt(r)===u.OPEN_BRACKET){0<r-e&&this.onText(function(){return t.substring(e,r)});var s=t.charCodeAt(r+1);s===u.FORWARD_SLASH?(n=Type.CLOSE_ELEMENT,r+=1):s===u.EXCLAMATION_POINT?u.startsWith(t,r+2,u.CDATA_PREFIX)?(n=Type.CDATA,r+=8):u.startsWith(t,r+2,u.COMMENT_PREFIX)&&(n=Type.COMMENT,r+=3):n=Type.ELEMENT}},u.extractAttributes=function(t,n,E){for(var e={},r=null,i=n;i<E;i++){var T=t.charCodeAt(i);null===r?T===u.EQUALS?(r=t.substring(n,i),n=i+=1):T!==u.SPACE&&T!==u.NEW_LINE||(n=i+=1):T!==u.DOUBLE_QUOTE&&T!==u.SINGLE_QUOTE||(e[r]=t.substring(n+1,i),n=i+1,r=null)}return e},u.startsWith=function(t,n,E){if(t.length-n<E.length)return!1;for(var e=0;e<E.length;e++)if(t.charCodeAt(n+e)!==E.charCodeAt(e))return!1;return!0},u.OPEN_BRACKET=60,u.FORWARD_SLASH=47,u.EXCLAMATION_POINT=33,u.EQUALS=61,u.NEW_LINE=10,u.SPACE=32,u.SINGLE_QUOTE=39,u.DOUBLE_QUOTE=34,u.CDATA_PREFIX="[CDATA[",u.CDATA_SUFFIX="]]>",u.ELEMENT_SUFFIX=">",u.COMMENT_PREFIX="--",u.COMMENT_SUFFIX="--\x3e",u}();module.exports=FastSax;