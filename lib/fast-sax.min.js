"use strict";var Type;!function(t){t[t.ELEMENT=0]="ELEMENT",t[t.CLOSE_ELEMENT=1]="CLOSE_ELEMENT",t[t.COMMENT=2]="COMMENT",t[t.CDATA=3]="CDATA"}(Type||(Type={}));var noOp=function(){},FastSax=function(){function O(){this.onText=noOp,this.onElementStart=noOp,this.onElementEnd=noOp,this.onCData=noOp,this.onComment=noOp}return O.prototype.parse=function(t){for(var E=null,n="\ufeff"===t.charAt(0)?1:0,e=n,r=n;r<t.length;r++)if(null!==E){if(E===Type.ELEMENT){if(-1===(A=t.indexOf(O.ELEMENT_SUFFIX,r)))break;for(var T=null,i=r;i<A;i++){var s=t[i];if(s===O.FORWARD_SLASH||s===O.SPACE||s===O.TAB||s===O.NEW_LINE||s===O.CARRIAGE_RETURN){T=t.substring(r,i),r=i;break}}null===T&&(T=t.substring(r,A)),T&&(this.onElementStart(T,function(){return O.extractAttributes(t,r,A)}),t[A-1]===O.FORWARD_SLASH&&this.onElementEnd(T)),r=A}else if(E===Type.CLOSE_ELEMENT){if(-1===(A=t.indexOf(O.ELEMENT_SUFFIX,r)))break;this.onElementEnd(t.substring(r,A)),r=A}else if(E===Type.CDATA){if(-1===(A=t.indexOf(O.CDATA_SUFFIX,r)))break;this.onCData(function(){return t.substring(r,A)}),r=A+2}else if(E===Type.COMMENT){var A;if(-1===(A=t.indexOf(O.COMMENT_SUFFIX,r)))break;this.onComment(function(){return t.substring(r,A)}),r=A+2}e=r+1,E=null}else if(t[r]===O.OPEN_BRACKET){0<r-e&&this.onText(function(){return t.substring(e,r)});var u=t[r+1];u===O.FORWARD_SLASH?(E=Type.CLOSE_ELEMENT,r+=1):u===O.EXCLAMATION_POINT?O.startsWith(t,r+2,O.CDATA_PREFIX)?(E=Type.CDATA,r+=8):O.startsWith(t,r+2,O.COMMENT_PREFIX)&&(E=Type.COMMENT,r+=3):E=Type.ELEMENT}},O.extractAttributes=function(t,E,n){for(var e={},r=null,T=E;T<n;T++){var i=t[T];null===r?i===O.EQUALS?(r=t.substring(E,T),E=T+=1):i!==O.FORWARD_SLASH&&i!==O.SPACE&&i!==O.TAB&&i!==O.NEW_LINE&&i!==O.CARRIAGE_RETURN||(E=T+1):i!==O.DOUBLE_QUOTE&&i!==O.SINGLE_QUOTE||(e[r]=t.substring(E+1,T),E=T+1,r=null)}return e},O.startsWith=function(t,E,n){return t.startsWith?t.startsWith(n,E):t.substr(E,n.length)===n},O.OPEN_BRACKET="<",O.FORWARD_SLASH="/",O.EXCLAMATION_POINT="!",O.EQUALS="=",O.SPACE=" ",O.TAB="\t",O.NEW_LINE="\n",O.CARRIAGE_RETURN="\r",O.SINGLE_QUOTE="'",O.DOUBLE_QUOTE='"',O.CDATA_PREFIX="[CDATA[",O.CDATA_SUFFIX="]]>",O.ELEMENT_SUFFIX=">",O.COMMENT_PREFIX="--",O.COMMENT_SUFFIX="--\x3e",O}();module.exports=FastSax;