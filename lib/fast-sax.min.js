"use strict";var Type;!function(t){t[t.ELEMENT=0]="ELEMENT",t[t.CLOSE_ELEMENT=1]="CLOSE_ELEMENT",t[t.COMMENT=2]="COMMENT",t[t.CDATA=3]="CDATA"}(Type||(Type={}));var noOp=function(){},FastSax=function(){function t(){this.onText=noOp,this.onElementStart=noOp,this.onElementEnd=noOp,this.onCData=noOp,this.onComment=noOp}return t.prototype.parse=function(n){for(var E=null,e="\ufeff"===n.charAt(0)?1:0,r=e,i=e;i<n.length;i++)if(null!==E){if(E===Type.ELEMENT){if(-1===(s=n.indexOf(t.ELEMENT_SUFFIX,i)))break;for(var T=null,A=i;A<s;A++){var o=n.charCodeAt(A);if(o===t.FORWARD_SLASH||o===t.SPACE){T=n.substring(i,A),i=A;break}}null===T&&(T=n.substring(i,s)),T&&(this.onElementStart(T,function(){return t.extractAttributes(n,i,s)}),n.charCodeAt(s-1)===t.FORWARD_SLASH&&this.onElementEnd(T)),i=s}else if(E===Type.CLOSE_ELEMENT){if(-1===(s=n.indexOf(t.ELEMENT_SUFFIX,i)))break;this.onElementEnd(n.substring(i,s)),i=s}else if(E===Type.CDATA){if(-1===(s=n.indexOf(t.CDATA_SUFFIX,i)))break;this.onCData(function(){return n.substring(i,s)}),i=s+2}else if(E===Type.COMMENT){var s=n.indexOf(t.COMMENT_SUFFIX,i);if(-1===s)break;this.onComment(function(){return n.substring(i,s)}),i=s+2}r=i+1,E=null}else if(n.charCodeAt(i)===t.OPEN_BRACKET){i-r>0&&this.onText(function(){return n.substring(r,i)});var u=n.charCodeAt(i+1);u===t.FORWARD_SLASH?(E=Type.CLOSE_ELEMENT,i+=1):u===t.EXCLAMATION_POINT?t.startsWith(n,i+2,t.CDATA_PREFIX)?(E=Type.CDATA,i+=8):t.startsWith(n,i+2,t.COMMENT_PREFIX)&&(E=Type.COMMENT,i+=3):E=Type.ELEMENT}},t.extractAttributes=function(n,E,e){for(var r={},i=null,T=E;T<e;T++){var A=n.charCodeAt(T);null===i?A===t.EQUALS?(i=n.substring(E,T),E=T+=1):A!==t.SPACE&&A!==t.NEW_LINE||(E=T+=1):A!==t.DOUBLE_QUOTE&&A!==t.SINGLE_QUOTE||(r[i]=n.substring(E+1,T),E=T+1,i=null)}return r},t.startsWith=function(t,n,E){if(t.length-n<E.length)return!1;for(var e=0;e<E.length;e++)if(t.charCodeAt(n+e)!==E.charCodeAt(e))return!1;return!0},t.OPEN_BRACKET=60,t.FORWARD_SLASH=47,t.EXCLAMATION_POINT=33,t.EQUALS=61,t.NEW_LINE=10,t.SPACE=32,t.SINGLE_QUOTE=39,t.DOUBLE_QUOTE=34,t.CDATA_PREFIX="[CDATA[",t.CDATA_SUFFIX="]]>",t.ELEMENT_SUFFIX=">",t.COMMENT_PREFIX="--",t.COMMENT_SUFFIX="--\x3e",t}();module.exports=FastSax;