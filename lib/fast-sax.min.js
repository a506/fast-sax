"use strict";var Type;!function(t){t[t.ELEMENT=0]="ELEMENT",t[t.CLOSE_ELEMENT=1]="CLOSE_ELEMENT",t[t.COMMENT=2]="COMMENT",t[t.CDATA=3]="CDATA"}(Type||(Type={}));var noOp=function(){},FastSax=function(){function t(){this.onText=noOp,this.onElementStart=noOp,this.onElementEnd=noOp,this.onCData=noOp,this.onComment=noOp}return t.prototype.parse=function(n){for(var E=null,e=0,r=0;r<n.length;r++)if(null!==E){if(E===Type.ELEMENT){if(-1===(o=n.indexOf(t.ELEMENT_SUFFIX,r)))break;for(var i=null,T=r;T<o;T++){var A=n.charCodeAt(T);if(A===t.FORWARD_SLASH||A===t.SPACE){i=n.substring(r,T),r=T;break}}null===i&&(i=n.substring(r,o)),i&&(this.onElementStart(i,function(){return t.extractAttributes(n,r,o)}),n.charCodeAt(o-1)===t.FORWARD_SLASH&&this.onElementEnd(i)),r=o}else if(E===Type.CLOSE_ELEMENT){if(-1===(o=n.indexOf(t.ELEMENT_SUFFIX,r)))break;this.onElementEnd(n.substring(r,o)),r=o}else if(E===Type.CDATA){if(-1===(o=n.indexOf(t.CDATA_SUFFIX,r)))break;this.onCData(function(){return n.substring(r,o)}),r=o+2}else if(E===Type.COMMENT){var o=n.indexOf(t.COMMENT_SUFFIX,r);if(-1===o)break;this.onComment(function(){return n.substring(r,o)}),r=o+2}e=r+1,E=null}else if(n.charCodeAt(r)===t.OPEN_BRACKET){var s=n.charCodeAt(r+1);s===t.FORWARD_SLASH?(r-e>0&&this.onText(function(){return n.substring(e,r)}),E=Type.CLOSE_ELEMENT,r+=1):s===t.EXCLAMATION_POINT?t.startsWith(n,r+2,t.CDATA_PREFIX)?(E=Type.CDATA,r+=8):t.startsWith(n,r+2,t.COMMENT_PREFIX)&&(E=Type.COMMENT,r+=3):E=Type.ELEMENT}},t.extractAttributes=function(n,E,e){for(var r={},i=null,T=E;T<e;T++){var A=n.charCodeAt(T);null===i?A===t.EQUALS?(i=n.substring(E,T),E=T+=1):A!==t.SPACE&&A!==t.NEW_LINE||(E=T+=1):A!==t.DOUBLE_QUOTE&&A!==t.SINGLE_QUOTE||(r[i]=n.substring(E+1,T),E=T+1,i=null)}return r},t.startsWith=function(t,n,E){if(t.length-n<E.length)return!1;for(var e=0;e<E.length;e++)if(t.charCodeAt(n+e)!==E.charCodeAt(e))return!1;return!0},t.OPEN_BRACKET=60,t.FORWARD_SLASH=47,t.EXCLAMATION_POINT=33,t.EQUALS=61,t.NEW_LINE=10,t.SPACE=32,t.SINGLE_QUOTE=39,t.DOUBLE_QUOTE=34,t.CDATA_PREFIX="[CDATA[",t.CDATA_SUFFIX="]]>",t.ELEMENT_SUFFIX=">",t.COMMENT_PREFIX="--",t.COMMENT_SUFFIX="--\x3e",t}();module.exports=FastSax;